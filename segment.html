<!DOCTYPE html>
<html>
<head>
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css' integrity='sha384-wE+lCONuEo/QSfLb4AfrSk7HjWJtc4Xc1OiB2/aDBzHzjnlBP4SX7vjErTcwlA8C' crossorigin='anonymous'>
<link rel='stylesheet' href='common.css'>
<script src='https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.js' integrity='sha384-tdtuPw3yx/rnUGmnLNWXtfjb9fpmwexsd+lr6HUYnUY4B7JhB5Ty7a1mYd+kto/s' crossorigin='anonymous'></script>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script>
<script src='util.js'></script>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<style>
#system {
    width: 80%;
    margin: 0 auto;
    border: thin solid;
}
#segment {
    position: relative
}
#euler {
    position: relative
}
</style>
</head>
<body>
<div id='main_page'>

<h4>Segment Intersection</h4>
<div class='math'>
\begin{matrix}
\hat b = \frac{\vec{b}}{|\vec{b}|} \\
\\
d_1+d_2 = \vec{v_2}\cdot\hat b - \vec{v_1}\cdot\hat b \\
\\
c_1 = \vec{v_1}\times\hat b \\
c_2 = \vec{v_2}\times\hat b \\
\\
\frac{d_1}{c_1} = \frac{d_1+d_2}{c_1+c_2}
\end{matrix}
</div>
<p>Simulation</p>
<div id='segment'></div>

<h4>Euler Equation</h4>
<div class='math'>
e^{-\gamma+i\omega} = e^{-\gamma t}(\cos\omega t+i\sin\omega t)
</div>
<p>Simulation</p>
<div id='euler'></div>

</div>

<script>
function run_segment() {
    var size = 700
    var canvas = Canvas('#segment', size, size)

    var a1 = Point2D(50, 150)
    var a2 = Point2D(650, 400)
    var b1 = Point2D(100, 650)
    var b2 = Point2D(650, 50)

    var ub = b2.sub(b1).unit()

    var v1 = a1.sub(b1)
    var v2 = a2.sub(b1)

    var d1 = v1.dot(ub)
    var d2 = v2.dot(ub)

    var c1 = ub.rot(v1)
    var c2 = v2.rot(ub)

    var pd1 = b1.add(ub.mul(d1))
    var pd2 = b1.add(ub.mul(d2))

    var po = pd1.add(ub.mul(c1*(d2-d1)/(c1+c2)))

    var default_style = canvas.style()
    var dash_style = {width:1, dash:[12, 7]}

    canvas.line(a1, a2)
    canvas.pike_line(b1, b2)

    canvas.pike(b1, pd1)
    canvas.pike(b1, pd2)

    canvas.line(a1, pd1, dash_style)
    canvas.line(a2, pd2)

    canvas.pike_line(b1, a1)
    canvas.pike_line(b1, a2)

    canvas.dot(po)

    canvas.text('O', po.add(Point2D(0, 15)))
    canvas.text('c_1', a1.add(pd1).div(2).add(Point2D(20, -10)))
    canvas.text('c_2', a2.add(pd2).div(2).add(Point2D(10, -20)))
    canvas.text('d_1', pd1.add(po).div(2).add(Point2D(5, 5)))
    canvas.text('d_2', pd2.add(po).div(2).add(Point2D(5, 5)))

    canvas.text('\\vec{b}', b2.add(Point2D(-30, 0)))
    canvas.text('\\vec{v_1}', v1.div(-2).add(a1).add(Point2D(10, 0)))
    canvas.text('\\vec{v_2}', v2.div(2).add(b1).add(Point2D(0, 10)))
    canvas.text('\\vec{v_1}\\cdot\\hat b', b1.add(pd1).div(2).add(Point2D(-20, -40)))
}

function run_euler() {
    var size = 700
    var canvas = Canvas('#euler', size, size)
    
    canvas.line(Point2D(0, 0), Point2D(size, size))
    
    var max = 200
    var middle = Point2D(size, size).div(2)

    function euler(t) {
        var damp = Math.pow(Math.E, -t/45)
        return Point2D(Math.cos(t), Math.sin(t))
            .mul(damp)
            .mul(max)
            .add(middle)
    }

    canvas.move_to(euler(0))
    for(var i = 0.01; i < 120; i+=0.01) {
        canvas.line_to(euler(i))
    }
    canvas.stroke()
}

run_segment()
run_euler()
render_katex()
test_lu()
</script>

</body>
</html>
