<!DOCTYPE html>
<html>
<head>
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css' integrity='sha384-wE+lCONuEo/QSfLb4AfrSk7HjWJtc4Xc1OiB2/aDBzHzjnlBP4SX7vjErTcwlA8C' crossorigin='anonymous'>
<link rel='stylesheet' href='common.css'>
<script src='https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.js' integrity='sha384-tdtuPw3yx/rnUGmnLNWXtfjb9fpmwexsd+lr6HUYnUY4B7JhB5Ty7a1mYd+kto/s' crossorigin='anonymous'></script>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script>
<script src='util.js'></script>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<style>
#field1_canvas, #field2_canvas, #_rot1_canvas, #_rot2_canvas {
    position: relative;

    width: 70%;
    margin-left: auto;
    margin-right: auto;
    display: block;
    border: thin solid;
}
</style>
</head>
<body>
<div id='main_page'>

<h3>Field Rotation Formula (3D - Cartesian)</h3>
<div class='math'>
\nabla \times A =
\begin{bmatrix}
\frac{\partial F_z}{\partial y} - \frac{\partial F_y}{\partial z} \\
\\
\frac{\partial F_x}{\partial z} - \frac{\partial F_z}{\partial x} \\
\\
\frac{\partial F_y}{\partial x} - \frac{\partial F_x}{\partial y}
\end{bmatrix}
</div>

<h3>Vector Field</h3>
<div class='math'>
A =
\begin{bmatrix}
y \\ -x \\ 0
\end{bmatrix}
</div>
<div id='field1_canvas'></div>

<h3>Rotation</h3>
<div class='math'>\nabla\times A</div>
<div id='_rot1_canvas'></div>

<h3>Vector Field</h3>
<div class='math'>
A =
\begin{bmatrix}
y^2 \\ x \\ 0
\end{bmatrix}
</div>
<div id='field2_canvas'></div>

<h3>Rotation</h3>
<div class='math'>\nabla \times A</div>
<div id='_rot2_canvas'></div>

</div>

<script>
function field1(pt) {
    return Point2D(2*pt.y, -2*pt.x)
}
function field2(pt) {
    return Point2D(pt.y*pt.y/2, pt.x)
}
function rot(pt, field_func) {
    var d = 0.1
    var v1 = field_func(pt.sub(d))
    var v2 = field_func(pt.add(d))
    return (v1.y - v2.y)/(2*d) - (v1.x - v2.x)/(2*d)
}
function render_field(anchor, field_func) {
    var size = 700
    var canvas = Canvas(anchor, size, size)

    var center = Point2D(size, size).div(2)
    for(var x = -5; x <= 5; x++) {
        for(var y = -5; y <= 5; y++) {
            var pt = Point2D(x, y)
            var start = pt.mul(70).add(center)
            var end = field_func(pt).mul(7).add(start)
            canvas.pike_line(start, end)
        }
    }
}
function render_rot(anchor, field_func) {
    var size = 700
    var canvas = Canvas(anchor, size, size)

    var d = 1.0
    var blue_style = {fill_color: 'blue'}
    var green_style = {fill_color: 'green'}
    var center = Point2D(size, size).div(2)
    for(var x = -5; x <= 5; x+=d) {
        for(var y = -5; y <= 5; y+=d) {
            var pt = Point2D(x, y)
            var start = pt.mul(70).add(center)

            var _rot = rot(pt, field_func)
            if(_rot < 0) {
                canvas.dot(start, -2*_rot, green_style)
            } else {
                canvas.dot(start, 2*_rot, blue_style)
            }

        }
    }
}
function render_field1() {
    render_field('#field1_canvas', field1)
    render_rot('#_rot1_canvas', field1)
}
function render_field2() {
    render_field('#field2_canvas', field2)
    render_rot('#_rot2_canvas', field2)
}
render_field1()
render_field2()
render_katex()
</script>

</body>
</html>
