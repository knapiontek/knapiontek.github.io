<!DOCTYPE html>
<html>
<head>
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css' integrity='sha384-wE+lCONuEo/QSfLb4AfrSk7HjWJtc4Xc1OiB2/aDBzHzjnlBP4SX7vjErTcwlA8C' crossorigin='anonymous'>
<script src='https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.js' integrity='sha384-tdtuPw3yx/rnUGmnLNWXtfjb9fpmwexsd+lr6HUYnUY4B7JhB5Ty7a1mYd+kto/s' crossorigin='anonymous'></script>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<style>
#main_page {
    padding: 2cm;
    width: 19cm;
    margin-left: auto;
    margin-right: auto;
    background-color: #ffffff;
    box-shadow: 10px 10px 5px #888888;
}
body {
    background-color: #cccccc;
    font: 14px Myriad,Helvetica,Tahoma,Arial,clean,sans-serif;
    font-size: 0.8em;
    line-height: 1.5em;
    margin-top: 1.5em;
    margin-bottom: 1.5em;
}
#system {
    width: 50%;
    margin: 0 auto;
    border: thin solid;
}
</style>
</head>
<body>
<div id='main_page'>

<p>Consider 2 cubic polynomial equations</p>
<div class='math'>
\begin{cases}
x_0(t) = a_0t^2 + b_0t + c_0 \\
x'_0(t) = 2a_0t + b_0
\end{cases}
\begin{cases}
x_1(t) = a_1t^2 + b_1t + c_1 \\
x'_1(t) = 2a_1t + b_1
\end{cases}
</div>

<p>Let's evaluated them in points <b class='inmath'>t=0, t=1</b></p>
<div class='math'>
\begin{cases}
x_0(0) = c_0 \\
x'_0(0) = b_0 \\
x_0(1) = a_0 + b_0 + c_0 \\
x'_0(1) = 2a_0 + b_0
\end{cases}
\begin{cases}
x_1(0) = c_1 \\
x'_1(0) = b_1 \\
x_1(1) = a_1 + b_1 + c_1 \\
x'_1(1) = 2a_1 + b_1
\end{cases}
</div>

<p>We add extra constraints for boundaries and to ensure continuity in the point of joining</p>
<div class='math'>
\begin{cases}
x'_0(0) = 0 \\
x'_0(1) = x'_1(0)
\end{cases}
</div>

<p>We can expand it for 3 fixed points <b class='inmath'>x_0, x_1, x_2</b></p>
<div class='math'>
\begin{cases}
x_0 = c_0 \\
x_1 = a_0 + b_0 + c_0 \\
x_1 = c_1 \\
x_2 = a_1 + b_1 + c_1 \\
b_0 = 0 \\
2a_0 + b_0 = b_1
\end{cases}
</div>

<p>Simplifying</p>
<div class='math'>
\begin{cases}
c_0 = x_0 \\
b_0 = 0 \\
a_0 = x_1 - b_0 - c_0 \\
c_1 = x_1 \\
b_1 = 2a_0 + b_0 \\
a_1 = x_2 - b_1 - c_1
\end{cases}
</div>

<div><canvas id='system'></div>

<script>
size = 1000
function arrow(context, begin, end) {
	line = {x: end.x - begin.x, y: end.y - begin.y}
	len = Math.sqrt((line.x * line.x) + (line.y * line.y))
	unit = {x: line.x / len, y: line.y / len}

	v = 25
	h = 8
	left = {
		x: end.x - (v * unit.x) + (h * unit.y),
		y: end.y - (v * unit.y) - (h * unit.x)
	}
	right = {
		x: end.x - (v * unit.x) - (h * unit.y),
		y: end.y - (v * unit.y) + (h * unit.x)
	}

	context.moveTo(begin.x, begin.y)
	context.lineTo(end.x, end.y)
	context.stroke()

	context.moveTo(end.x, end.y)
	context.lineTo(left.x, left.y)
	context.lineTo(right.x, right.y)
	context.fill()
}
function render_spline() {
	data = [{x:100, y:100}, {x:500, y:800}, {x:800, y:900}]

	var xc0 = data[0].x
	var xb0 = 0
	var xa0 = data[1].x - xb0 - xc0
	var xc1 = data[1].x
	var xb1 = 2*xa0 + xb0
	var xa1 = data[2].x - xb1 - xc1

	var yc0 = data[0].y
	var yb0 = 0
	var ya0 = data[1].y - yb0 - yc0
	var yc1 = data[1].y
	var yb1 = 2*ya0 + yb0
	var ya1 = data[2].y - yb1 - yc1

    var system = $('#system').get(0)
    var context = system.getContext('2d')
    system.width = size
    system.height = size
    context.clearRect(0, 0, size, size)

	context.beginPath()
	context.fillStyle = 'blue'

	//context.moveTo(data[0].x, data[0].y)
	//for(var i = 1; i < 3; i++) {
	//	context.lineTo(data[i].x, data[i].y)
	//}
	
	context.moveTo(xc0, yc0)
	for(var t = 0; t <= 1; t += 0.1) {
		var x = (xa0*t*t) + (xb0*t) + xc0
		var y = (ya0*t*t) + (yb0*t) + yc0
		context.lineTo(x, y)
	}
	context.stroke()
}
function render_field() {
    var system = $('#system').get(0)
    var context = system.getContext('2d')
    system.width = size
    system.height = size
    context.clearRect(0, 0, size, size)
	context.beginPath()
	context.fillStyle = 'blue'
	context.moveTo(500, 500)
	context.lineTo(1000, 1000)
	context.stroke()
	arrow(context, {x: 100, y: 100}, {x: 200, y: 250})
	arrow(context, {x: 100, y: 100}, {x: 150, y: 50})
	
	pi = Math.atan(1)
	pi_step = pi / 8
	for(var i = 0; i < 2 * pi; i+=pi_step) {
		var center = {x: 500, y: 500}
		var ray = {x: 400*Math.cos(i), y: 400*Math.sin(i)}
		arrow(context, center, ray)
	}
}
function render_katex() {
    $('.math').each(function() {
        var texTxt = $(this).text()
        elem = $(this).get(0)
        try {
            katex.render(texTxt, elem, { displayMode: true })
        }
        catch(err) {
            $(this).html('<span class="error">' + err)
        }
    })
    $('.inmath').each(function() {
        var texTxt = $(this).text()
        elem = $(this).get(0)
        try {
            katex.render(texTxt, elem, { displayMode: false })
        }
        catch(err) {
            $(this).html('<span class="error">' + err)
        }
    })
}
render_spline()
//render_field()
render_katex()
</script>
</body>
</html>
