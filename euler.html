<!DOCTYPE html>
<html>
<head>
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css' integrity='sha384-wE+lCONuEo/QSfLb4AfrSk7HjWJtc4Xc1OiB2/aDBzHzjnlBP4SX7vjErTcwlA8C' crossorigin='anonymous'>
<link rel='stylesheet' href='common.css'>
<script src='https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.js' integrity='sha384-tdtuPw3yx/rnUGmnLNWXtfjb9fpmwexsd+lr6HUYnUY4B7JhB5Ty7a1mYd+kto/s' crossorigin='anonymous'></script>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script>
<script src='util.js'></script>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<style>
#euler {
    position: relative;

    width: 70%;
    margin-left: auto;
    margin-right: auto;
    display: block;
    border: thin solid;
}
#simulation {
    position: relative;

    width: 100%;
    margin-left: auto;
    margin-right: auto;
    display: block;
    border: thin solid;
}
</style>
</head>
<body>
<div id='main_page'>

<h4>Euler Equation</h4>
<div class='math'>
e^{i\omega} = \cos\omega + i\sin\omega
</div>

<h4>Euler Identity</h4>
<div class='math'>
e^{i\pi} - 1 = 0
</div>

<h4>Euler Function</h4>
<div class='math'>
e^{-\gamma+i\omega} = e^{-\gamma t}(\cos\omega t+i\sin\omega t)
</div>
<p>Simulation</p>
<div id='euler'></div>

<h4>Solving <b class='inmath'>i^i</b></h4>
<div class='math'>
\begin{matrix}
i = \cos\frac{\pi}{2} + i\sin\frac{\pi}{2} = e^{i\frac{\pi}{2}} \\
\\
i^i = (e^{i\frac{\pi}{2}})^i = e^{ii\frac{\pi}{2}} = e^{-\frac{\pi}{2}}
\end{matrix}
</div>

<h4>Homogeneous Ordinary Differential Equations</h4>
<p>General form</p>
<div class='math'>
ay'' + by' + cy = 0
</div>
<p>General solution is expected to be in a form of exponential function</p>
<div class='math'>
y = e^{rt}
</div>
<p>Let's plug it in</p>
<div class='math'>
a(e^{rt})'' + b(e^{rt})' + c(e^{rt}) = 0
</div>
<div class='math'>
ar^2e^{rt} + bre^{rt} + ce^{rt} = 0
</div>
<div class='math'>
(ar^2 + br + c)e^{rt} = 0
</div>
<div class='math'>
ar^2 + br + c = 0
</div>
<p>When roots are real we obtain a solution in the form</p>
<div class='math'>
y = c_1e^{r_1t} + c_2e^{r_2t}
</div>
<p>We need to fix boundaries to find coefficients <b class='inmath'>c_1, c_2</b></p>
<div class='math'>
\begin{cases}
y(t) = c_1e^{r_1t} + c_2e^{r_2t} \\
y'(t) = c_1r_1e^{r_1t} + c_2r_2e^{r_2t}
\end{cases}
</div>
<p>When roots are complex we obtain a solution in the form</p>
<div class='math'>
y = c_1e^{(\gamma+i\omega)t} + c_2e^{(\gamma-i\omega)t}
</div>
<p>Using Euler equation</p>
<div class='math'>
\begin{cases}
e^{i\omega t} = \cos\omega t + i\sin\omega t \\
e^{-i\omega t} = \cos\omega t - i\sin\omega t
\end{cases}
</div>
<p>We get</p>
<div class='math'>
\begin{cases}
y_1 = c_1e^{(\gamma+i\omega)t} = c_1e^{\gamma t}e^{i\omega t} = c_1e^{\gamma t}(\cos\omega t + i\sin\omega t) \\
y_2 = c_2e^{(\gamma-i\omega)t} = c_2e^{\gamma t}e^{-i\omega t} = c_2e^{\gamma t}(\cos\omega t -i\sin\omega t)
\end{cases}
</div>
<p>Let's manipulate it as follows</p>
<div class='math'>
\begin{cases}
y_1^* = y_1 + y_2 = 2(c_1+c_2)e^{\gamma t}\cos\omega t \\
y_2^* = y_1 - y_2 = 2(c_1-c_2)ie^{\gamma t}\sin\omega t
\end{cases}
</div>
<p>After constant consolidation finally we obtain</p>
<div class='math'>
y = y_1^* + y_2^* = c_1^*e^{\gamma t}\cos\omega t + c_2^*e^{\gamma t}\sin\omega t
</div>
<p>Yet another form of coefficients</p>
<div class='math'>
y = e^{\gamma t}R\cos\phi\cos\omega t + e^{\gamma t}R\sin\phi\sin\omega t
</div>
<p>Yields to</p>
<div class='math'>
y = e^{\gamma t}R\cos(\omega t - \phi)
</div>

<h4>Numeric example</h4>
<div class='math'>
y'' + 2y' + 65y = 0
</div>
<div class='math'>
r^2 + 2r + 65 = 0
</div>
<div class='math'>
\begin{cases}
r_1 = -1-i8 \\
r_2 = -1+i8
\end{cases}
</div>
<div class='math'>
\begin{cases}
y = c_1e^{-t}\cos 8t + c_2e^{-t}\sin 8t \\
y' = -c_1e^{-t}\cos 8t - 8c_1e^{-t}\sin 8t - c_2e^{-t}\sin 8t + 8c_2e^{-t}\cos 8t
\end{cases}
</div>
<p>By fixing <b class='inmath'>c_2=0,\;y(0)=0.7,\;y'(0)=-0.7</b> we get the solution</p>
<div class='math'>
y = 0.7e^{-t}\cos 8t
</div>

<p>Lets compare analytical solution with numerical method</p>

<p>Order reduction</p>
<div class='math'>
\begin{cases}
y' = x \\
x' + 2x + 65y = 0
\end{cases}
</div>

<p>Approximation by Euler method <b class='inmath'>\mathcal{O}(\Delta t)</b></p>
<div class='math'>
\begin{cases}
\frac{\Delta y}{\Delta t} = x \\
\\
\frac{\Delta x}{\Delta t} = -2x - 65y
\end{cases}
</div>

<p>Recursive algorithm</p>
<div class='math'>
\begin{cases}
y_{n+1} = y_n + x_n \Delta t \\
x_{n+1} = x_n - 2x_n \Delta t - 65y_{n+1} \Delta t
\end{cases}
</div>

<p>Simulation</p>
<p>Press [+] or [-] to change <i class='inmath'>\Delta t=</i><i id='step'>step</i></p>
<div id='simulation'></div>

<p>Remark</p>
<ul>
<li>The solution is very <i>smooth</i> therefore the first order approximation produces satisfying results. I had to set <b class='inmath'>\Delta t=0.03</b> to make the difference visible.</li>
</ul>

</div>

<script>
function run_euler() {
    var size = 700
    var canvas = Canvas('#euler', size, size)
    var path = canvas.Path()

    path.line(Point2D(0, 0), Point2D(size, size))

    var max = 200
    var middle = Point2D(size, size).div(2)

    function euler(t) {
        var damp = Math.pow(Math.E, -t/45)
        return Point2D(Math.cos(t), Math.sin(t))
            .mul(damp)
            .mul(max)
            .add(middle)
    }

    path.move_to(euler(0))
    for(var i = 0.01; i < 120; i+=0.01) {
        path.line_to(euler(i))
    }
    path.stroke()
}

var size = 1000
var canvas = Canvas('#simulation', size, size/2)
function run_calculation(step) {
    canvas.erase()

    var scale_y = 300
    var scale_t = 400
    var margin = 10
    var x1 = margin
    var x2 = size - margin
    var y1 = margin
    var y2 = size/2 - margin
    var ym = size/4 - margin

    var axis_path = canvas.Path()
    axis_path.pike_line(Point2D(x1, y2), Point2D(x1, y1))
    axis_path.pike_line(Point2D(x1, ym), Point2D(x2, ym))

	var c = 0.7
	var alpha = -1.0
	var beta = 8.0
    var dt = 0.01

    var solid_path = canvas.Path()
    solid_path.move_to(Point2D(x1, ym-scale_y*c))
    for(var t = dt; x1+scale_t*t < x2; t += dt) {
		var y = c*Math.pow(Math.E, alpha*t) * Math.cos(beta*t)
        solid_path.line_to(Point2D(x1+scale_t*t, ym-scale_y*y))
    }
    solid_path.stroke()

	var x = -0.7 // 1-st derivative at 0
	var y = 0.7 // function value at 0
    var dt = step

    var dash_path = canvas.Path({width:1, dash:[12, 7]})
    dash_path.move_to(Point2D(x1, ym-scale_y*y))
    for(var t = dt; x1+scale_t*t < x2; t += dt) {
		y = y + x*dt
		x = x - 2*x*dt - 65*y*dt
        dash_path.line_to(Point2D(x1+scale_t*t, ym-scale_y*y))
    }
    dash_path.stroke()
}

run_euler()
var step = 0.03
run_calculation(step)
render_katex()
$('#step').text(step)
$(window).keydown(function(event) {
    var min_value = 0.001
    switch(event.which) {
        case 109:
            step -= min_value
            break
        case 107:
            step += min_value
            break
        default:
            return
    }
    if(step < min_value) {
        step = min_value
    }
    $('#step').text(step.toFixed(3))
    run_calculation(step)
})
</script>

</body>
</html>
